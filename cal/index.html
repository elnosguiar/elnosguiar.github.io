<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UNIVERSE FINANCE CALCULATOR</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    height: 100%;
    background: black;
    font-family: 'Segoe UI', Arial;
    touch-action: none;
}

/* ë„¤ë·¸ë¼ */
.nebula {
    position: absolute;
    width: 200vw;
    height: 200vh;
    top: -50vh;
    left: -50vw;
    background: radial-gradient(circle,
        rgba(80, 0, 255, 0.22) 0%,
        rgba(0, 0, 0, 0) 70%);
    mix-blend-mode: screen;
    animation: spin1 120s linear infinite;
}
.nebula:nth-child(2) {
    background: radial-gradient(circle,
        rgba(0, 200, 255, 0.18) 0%,
        rgba(0, 0, 0, 0) 70%);
    animation: spin2 180s linear infinite;
}

@keyframes spin1 { from {transform: rotate(0deg);} to {transform: rotate(360deg);} }
@keyframes spin2 { from {transform: rotate(360deg);} to {transform: rotate(0deg);} }

/* ì¤‘ì•™ UI ì¹´ë“œ */
.calculator-panel {
    position: absolute;
    top: 52%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 850px;
    background: rgba(10, 15, 40, 0.72);
    box-shadow: 0 0 25px #4fa3ff60, inset 0 0 30px #6fb5ff30;
    backdrop-filter: blur(12px);
    border-radius: 20px;
    padding: 25px;
    color: #e9f2ff;
    z-index: 999;
}

/* ìƒë‹¨ ì‹œê³„ */
.clock-box {
    text-align: center;
    font-size: 1.3rem;
    color: #bcd9ff;
    margin-bottom: 20px;
    text-shadow: 0 0 10px #4fa3ff;
}

/* TAB ë²„íŠ¼ */
.tab-buttons {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}
.tab-buttons button {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 10px;
    background: rgba(50, 70, 120, 0.3);
    color: #d9e6ff;
    font-size: 1rem;
    cursor: pointer;
    transition: 0.25s;
}
.tab-buttons button.active {
    background: #4fa3ff;
    color: #001;
    font-weight: bold;
    box-shadow: 0 0 15px #4fa3ff;
}

/* tab area */
.tab {
    display: none;
}
.tab.active { display: block; }

/* label/input */
label {
    margin: 6px 0 3px;
    display: block;
    color: #d0e0ff;
    text-shadow: 0 0 6px #4fa3ff50;
}
input, select {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 8px;
    background: rgba(15, 25, 45, 0.7);
    color: #fff;
    font-size: 1rem;
    margin-bottom: 12px;
    outline: none;
    box-shadow: inset 0 0 8px #4fa3ff30;
}

/* ë²„íŠ¼ */
.calculate {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 10px;
    background: #4fa3ff;
    color: #000;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    margin-top: 10px;
    box-shadow: 0 0 15px #4fa3ff;
}

.result-box {
    margin-top: 18px;
    padding: 15px;
    background: rgba(10, 15, 35, 0.65);
    border-radius: 10px;
    line-height: 1.8;
    text-shadow: 0 0 6px #4fa3ff50;
}

.chart-container {
    margin-top: 20px;
    background: rgba(10, 15, 35, 0.6);
    padding: 15px;
    border-radius: 12px;
}
</style>
</head>
<body>

<!-- ìš°ì£¼ ë„¤ë·¸ë¼ -->
<div class="nebula"></div>
<div class="nebula"></div>

<!-- ë³„ ë°°ê²½ ìº”ë²„ìŠ¤ -->
<canvas id="space"></canvas>

<!-- ë©”ì¸ ê³„ì‚°ê¸° íŒ¨ë„ -->
<div class="calculator-panel">

    <!-- ë‚ ì§œ / ì‹œê³„ -->
    <div class="clock-box" id="clockDisplay"></div>

    <!-- TAB ë²„íŠ¼ -->
    <div class="tab-buttons">
        <button class="active" onclick="showTab('deposit')">ì˜ˆê¸ˆ</button>
        <button onclick="showTab('saving')">ì ê¸ˆ</button>
        <button onclick="showTab('loan')">ëŒ€ì¶œ</button>
    </div>

    <!-- ì˜ˆê¸ˆ TAB -->
    <div id="deposit" class="tab active">
        <label>ì˜ˆì¹˜ê¸ˆì•¡(ì›)</label>
        <input type="text" id="dep_amount" class="num">

        <label>ì—° ì´ììœ¨(%)</label>
        <input type="text" id="dep_rate" class="num">

        <label>ê¸°ê°„(ê°œì›”)</label>
        <input type="text" id="dep_month" class="num">

        <label>ì´ì ë°©ì‹</label>
        <select id="dep_type">
            <option value="simple">ë‹¨ë¦¬</option>
            <option value="monthly">ì›”ë³µë¦¬</option>
            <option value="yearly">ì—°ë³µë¦¬</option>
        </select>

        <button class="calculate" onclick="calcDeposit()">ê³„ì‚°í•˜ê¸°</button>

        <div id="dep_result" class="result-box"></div>
        <div class="chart-container"><canvas id="dep_chart"></canvas></div>
    </div>

    <!-- ì ê¸ˆ TAB -->
    <div id="saving" class="tab">
        <label>ì›” ë‚©ì…ì•¡(ì›)</label>
        <input type="text" id="sav_amount" class="num">

        <label>ì—° ì´ììœ¨(%)</label>
        <input type="text" id="sav_rate" class="num">

        <label>ê¸°ê°„(ê°œì›”)</label>
        <input type="text" id="sav_month" class="num">

        <label>ì´ì ë°©ì‹</label>
        <select id="sav_type">
            <option value="compound">ë³µë¦¬(ì€í–‰ì‹)</option>
            <option value="simple">ë‹¨ë¦¬</option>
        </select>

        <button class="calculate" onclick="calcSaving()">ê³„ì‚°í•˜ê¸°</button>

        <div id="sav_result" class="result-box"></div>
        <div class="chart-container"><canvas id="sav_chart"></canvas></div>
    </div>

    <!-- ëŒ€ì¶œ TAB -->
    <div id="loan" class="tab">
        <label>ëŒ€ì¶œê¸ˆì•¡(ì›)</label>
        <input type="text" id="loan_amount" class="num">

        <label>ì—° ì´ììœ¨(%)</label>
        <input type="text" id="loan_rate" class="num">

        <label>ê¸°ê°„(ê°œì›”)</label>
        <input type="text" id="loan_month" class="num">

        <label>ìƒí™˜ ë°©ì‹</label>
        <select id="loan_type">
            <option value="amortization">ì›ë¦¬ê¸ˆê· ë“±</option>
            <option value="principal">ì›ê¸ˆê· ë“±</option>
            <option value="bullet">ë§Œê¸°ì¼ì‹œ</option>
        </select>

        <button class="calculate" onclick="calcLoan()">ê³„ì‚°í•˜ê¸°</button>

        <div id="loan_result" class="result-box"></div>
        <div class="chart-container"><canvas id="loan_chart"></canvas></div>
    </div>

</div>

<script>
/* =============================
       ì‹¤ì‹œê°„ ë‚ ì§œ / ì‹œê³„
================================*/
function updateClock() {
    const now = new Date();
    const y = now.getFullYear();
    const m = String(now.getMonth()+1).padStart(2,'0');
    const d = String(now.getDate()).padStart(2,'0');
    const days = ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];
    const wd = days[now.getDay()];
    const hh = String(now.getHours()).padStart(2,'0');
    const mm = String(now.getMinutes()).padStart(2,'0');
    const ss = String(now.getSeconds()).padStart(2,'0');

    clockDisplay.textContent = `${y}-${m}-${d} (${wd}) ${hh}:${mm}:${ss}`;
}
setInterval(updateClock, 1000);
updateClock();

/* =============================
        TAB ì „í™˜
================================*/
function showTab(id) {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    document.getElementById(id).classList.add("active");

    document.querySelectorAll(".tab-buttons button").forEach(b => b.classList.remove("active"));
    event.target.classList.add("active");
}

/* ============================
     ìˆ«ì ì…ë ¥ â†’ ì½¤ë§ˆ ìë™
=============================*/
function addComma(num){ return num.toLocaleString('ko-KR'); }
function uncomma(str){ return Number(str.replace(/,/g,"")); }

document.querySelectorAll(".num").forEach(i=>{
    i.addEventListener("input", function(){
        let raw = this.value.replace(/,/g,"");
        if(!isNaN(raw) && raw !== ""){
            this.value = Number(raw).toLocaleString();
        }
    });
});

/* =============================
          ì˜ˆê¸ˆ ê³„ì‚°
================================*/
let depChart;

function calcDeposit(){
    const P = uncomma(dep_amount.value);
    const r = Number(uncomma(dep_rate.value)) / 100;
    const m = Number(uncomma(dep_month.value));
    const type = dep_type.value;

    let total=0;

    if(type==="simple") total = P * (1 + r*(m/12));
    if(type==="monthly") total = P * (1+r/12)**m;
    if(type==="yearly") total = P * (1+r)**(m/12);

    const interest = total - P;

    dep_result.innerHTML = `
    ğŸ’° <b>ì˜ˆê¸ˆ ê²°ê³¼</b><br>
    ì›ê¸ˆ: ${addComma(P)}ì›<br>
    ì´ì: ${addComma(Math.round(interest))}ì›<br>
    ë§Œê¸°ìˆ˜ë ¹ì•¡: <b>${addComma(Math.round(total))}ì›</b>
    `;

    if(depChart) depChart.destroy();
    depChart = new Chart(dep_chart, {
        type:"line",
        data:{
            labels:["ì›ê¸ˆ","ë§Œê¸°"],
            datasets:[{
                label:"ì˜ˆê¸ˆ ì¦ê°€",
                data:[P,total],
                borderColor:"#4fa3ff",
                tension:0.3
            }]
        }
    });
}

/* =============================
           ì ê¸ˆ ê³„ì‚°
================================*/
let savChart;
function calcSaving(){
    const A = uncomma(sav_amount.value);
    const rate = Number(uncomma(sav_rate.value))/100;
    const n = Number(uncomma(sav_month.value));
    const type = sav_type.value;

    let total=0;

    if(type==="compound"){
        const r = rate/12;
        total = A*(( (1+r)**n -1 )/r);
    }
    if(type==="simple"){
        total = A*n + A*(n+1)/2*rate*(1/12);
    }

    const paid = A*n;
    const interest = total - paid;

    sav_result.innerHTML = `
    ğŸ“¦ <b>ì ê¸ˆ ê²°ê³¼</b><br>
    ì´ ë‚©ì…ì•¡: ${addComma(paid)}ì›<br>
    ì´ì: ${addComma(Math.round(interest))}ì›<br>
    ë§Œê¸°ìˆ˜ë ¹ì•¡: <b>${addComma(Math.round(total))}ì›</b>
    `;

    if(savChart) savChart.destroy();
    savChart = new Chart(sav_chart, {
        type:"line",
        data:{
            labels:Array.from({length:n},(_,i)=>i+1),
            datasets:[{
                label:"ì ê¸ˆ ëˆ„ì  ë‚©ì…ì•¡",
                data:Array.from({length:n},(_,i)=>A*(i+1)),
                borderColor:"#4fa3ff",
                tension:0.4
            }]
        }
    });
}

/* =============================
           ëŒ€ì¶œ ê³„ì‚°
================================*/
let loanChart;

function calcLoan(){
    const L = uncomma(loan_amount.value);
    const r = Number(uncomma(loan_rate.value)) /100/12;
    const n = Number(uncomma(loan_month.value));
    const type = loan_type.value;

    let monthly=0;
    let total=0;
    let interest=0;

    if(type==="amortization"){
        monthly = L*(r*(1+r)**n)/((1+r)**n -1);
        total = monthly*n;
        interest = total-L;
    }

    if(type==="principal"){
        let principal = L/n;
        let totalInterest=0;
        for(let i=0;i<n;i++){
            totalInterest += (L - principal*i)*r;
        }
        interest = totalInterest;
        total = L+interest;
        monthly = "ë§¤ì›” ì›ê¸ˆ "+addComma(Math.round(principal))+"ì› + ì´ì";
    }

    if(type==="bullet"){
        interest = L*r*n;
        total = L+interest;
        monthly = "ë§¤ì›” ì´ì "+addComma(Math.round(L*r))+"ì›";
    }

    loan_result.innerHTML = `
    ğŸ¦ <b>ëŒ€ì¶œ ê²°ê³¼</b><br>
    ì›” ë‚©ì…ì•¡: ${typeof monthly==="string"?monthly:addComma(Math.round(monthly))+"ì›"}<br>
    ì´ ì´ì: ${addComma(Math.round(interest))}ì›<br>
    ìµœì¢… ìƒí™˜ì•¡: <b>${addComma(Math.round(total))}ì›</b>
    `;

    if(loanChart) loanChart.destroy();
    loanChart = new Chart(loan_chart, {
        type:"doughnut",
        data:{
            labels:["ì›ê¸ˆ","ì´ì"],
            datasets:[{
                data:[L,interest],
                backgroundColor:["#4fa3ff","#ff5577"]
            }]
        }
    });
}

/* =============================
        ìš°ì£¼ ìŠ¤íƒ€í•„ë“œ
================================*/
const canvas = document.getElementById("space");
const ctx = canvas.getContext("2d");

let w,h;
function resize(){
    w=canvas.width=window.innerWidth;
    h=canvas.height=window.innerHeight;
}
window.addEventListener("resize",resize);
resize();

let stars=[];
let count=1000;
let focal=500;

function initStars(){
    stars=[];
    for(let i=0;i<count;i++){
        stars.push({
            x:(Math.random()-0.5)*w,
            y:(Math.random()-0.5)*h,
            z:Math.random()*focal,
            speed:0.4+Math.random()*1
        });
    }
}
initStars();

function animate(){
    ctx.clearRect(0,0,w,h);

    for(let s of stars){
        s.z-=s.speed;
        if(s.z<=0){
            s.z=focal;
            s.x=(Math.random()-0.5)*w;
            s.y=(Math.random()-0.5)*h;
        }

        let k=focal/s.z;
        let px=s.x*k+w/2;
        let py=s.y*k+h/2;

        ctx.fillStyle="rgba(255,255,255,"+(1-s.z/focal)+")";
        ctx.beginPath();
        ctx.arc(px,py,1.2+(1-s.z/focal)*2,0,Math.PI*2);
        ctx.fill();
    }

    requestAnimationFrame(animate);
}
animate();
</script>

</body>
</html>
